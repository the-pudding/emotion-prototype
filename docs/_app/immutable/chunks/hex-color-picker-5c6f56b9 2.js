const c=(e,t=0,o=1)=>e>o?o:e<t?t:e,i=(e,t=0,o=Math.pow(10,t))=>Math.round(o*e)/o,T=e=>z(g(e)),g=e=>(e[0]==="#"&&(e=e.substr(1)),e.length<6?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:1}:{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:1}),L=e=>A(q(e)),I=({h:e,s:t,v:o,a:s})=>{const r=(200-t)*o/100;return{h:i(e),s:i(r>0&&r<200?t*o/100/(r<=100?r:200-r)*100:0),l:i(r/2),a:i(s,2)}},m=e=>{const{h:t,s:o,l:s}=I(e);return`hsl(${t}, ${o}%, ${s}%)`},q=({h:e,s:t,v:o,a:s})=>{e=e/360*6,t=t/100,o=o/100;const r=Math.floor(e),n=o*(1-t),a=o*(1-(e-r)*t),d=o*(1-(1-e+r)*t),h=r%6;return{r:i([o,a,n,n,d,o][h]*255),g:i([d,o,o,a,n,n][h]*255),b:i([n,n,d,o,o,a][h]*255),a:i(s,2)}},p=e=>{const t=e.toString(16);return t.length<2?"0"+t:t},A=({r:e,g:t,b:o})=>"#"+p(e)+p(t)+p(o),z=({r:e,g:t,b:o,a:s})=>{const r=Math.max(e,t,o),n=r-Math.min(e,t,o),a=n?r===e?(t-o)/n:r===t?2+(o-e)/n:4+(e-t)/n:0;return{h:i(60*(a<0?a+6:a)),s:i(r?n/r*100:0),v:i(r/255*100),a:s}},H=(e,t)=>{if(e===t)return!0;for(const o in e)if(e[o]!==t[o])return!1;return!0},O=(e,t)=>e.toLowerCase()===t.toLowerCase()?!0:H(g(e),g(t)),y={},E=e=>{let t=y[e];return t||(t=document.createElement("template"),t.innerHTML=e,y[e]=t),t},v=(e,t,o)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:o}))};let l=!1;const x=e=>"touches"in e,P=e=>l&&!x(e)?!1:(l||(l=x(e)),!0),w=(e,t)=>{const o=x(t)?t.touches[0]:t,s=e.el.getBoundingClientRect();v(e.el,"move",e.getMove({x:c((o.pageX-(s.left+window.pageXOffset))/s.width),y:c((o.pageY-(s.top+window.pageYOffset))/s.height)}))},B=(e,t)=>{const o=t.keyCode;o>40||e.xy&&o<37||o<33||(t.preventDefault(),v(e.el,"move",e.getMove({x:o===39?.01:o===37?-.01:o===34?.05:o===33?-.05:o===35?1:o===36?-1:0,y:o===40?.01:o===38?-.01:0},!0)))};class S{constructor(t,o,s,r){const n=E(`<div role="slider" tabindex="0" part="${o}" ${s}><div part="${o}-pointer"></div></div>`);t.appendChild(n.content.cloneNode(!0));const a=t.querySelector(`[part=${o}]`);a.addEventListener("mousedown",this),a.addEventListener("touchstart",this),a.addEventListener("keydown",this),this.el=a,this.xy=r,this.nodes=[a.firstChild,a]}set dragging(t){const o=t?document.addEventListener:document.removeEventListener;o(l?"touchmove":"mousemove",this),o(l?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!P(t)||!l&&t.button!=0)return;this.el.focus(),w(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),w(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":B(this,t);break}}style(t){t.forEach((o,s)=>{for(const r in o)this.nodes[s].style.setProperty(r,o[r])})}}class D extends S{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:m({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${i(t)}`)}getMove(t,o){return{h:o?c(this.h+t.x*360,0,360):360*t.x}}}class R extends S{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:m(t)},{"background-color":m({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${i(t.s)}%, Brightness ${i(t.v)}%`)}getMove(t,o){return{s:o?c(this.hsva.s+t.x*100,0,100):t.x*100,v:o?c(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const j=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',N="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",V="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",u=Symbol("same"),f=Symbol("color"),$=Symbol("hsva"),b=Symbol("update"),M=Symbol("parts"),k=Symbol("css"),C=Symbol("sliders");class X extends HTMLElement{static get observedAttributes(){return["color"]}get[k](){return[j,N,V]}get[C](){return[R,D]}get color(){return this[f]}set color(t){if(!this[u](t)){const o=this.colorModel.toHsva(t);this[b](o),this[f]=t}}constructor(){super();const t=E(`<style>${this[k].join("")}</style>`),o=this.attachShadow({mode:"open"});o.appendChild(t.content.cloneNode(!0)),o.addEventListener("move",this),this[M]=this[C].map(s=>new s(o))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,o,s){const r=this.colorModel.fromAttr(s);this[u](r)||(this.color=r)}handleEvent(t){const o=this[$],s={...o,...t.detail};this[b](s);let r;!H(s,o)&&!this[u](r=this.colorModel.fromHsva(s))&&(this[f]=r,v(this,"color-changed",{value:r}))}[u](t){return this.color&&this.colorModel.equal(t,this.color)}[b](t){this[$]=t,this[M].forEach(o=>o.update(t))}}const Y={defaultColor:"#000",toHsva:T,fromHsva:L,equal:O,fromAttr:e=>e};class _ extends X{get colorModel(){return Y}}class F extends _{}customElements.define("hex-color-picker",F);export{F as HexColorPicker};
